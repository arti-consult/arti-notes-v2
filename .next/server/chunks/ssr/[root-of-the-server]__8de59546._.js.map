{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/contexts/OnboardingContext.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const OnboardingProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call OnboardingProvider() from the server but OnboardingProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/OnboardingContext.tsx <module evaluation>\",\n    \"OnboardingProvider\",\n);\nexport const useOnboarding = registerClientReference(\n    function() { throw new Error(\"Attempted to call useOnboarding() from the server but useOnboarding is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/OnboardingContext.tsx <module evaluation>\",\n    \"useOnboarding\",\n);\n"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,qBAAqB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACpD;IAAa,MAAM,IAAI,MAAM;AAAoP,GACjR,oEACA;AAEG,MAAM,gBAAgB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,oEACA","debugId":null}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/contexts/OnboardingContext.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const OnboardingProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call OnboardingProvider() from the server but OnboardingProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/OnboardingContext.tsx\",\n    \"OnboardingProvider\",\n);\nexport const useOnboarding = registerClientReference(\n    function() { throw new Error(\"Attempted to call useOnboarding() from the server but useOnboarding is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/OnboardingContext.tsx\",\n    \"useOnboarding\",\n);\n"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,qBAAqB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACpD;IAAa,MAAM,IAAI,MAAM;AAAoP,GACjR,gDACA;AAEG,MAAM,gBAAgB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,gDACA","debugId":null}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/utils/supabase/server.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { createServerClient } from \"@supabase/ssr\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies();\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        get(name: string) {\r\n          return cookieStore.get(name)?.value;\r\n        },\r\n        set(name: string, value: string, options: any) {\r\n          try {\r\n            cookieStore.set({ name, value, ...options });\r\n          } catch (error) {\r\n            // Handle cookie setting error\r\n            console.error(\"Error setting cookie:\", error);\r\n          }\r\n        },\r\n        remove(name: string, options: any) {\r\n          try {\r\n            cookieStore.set({ name, value: \"\", ...options });\r\n          } catch (error) {\r\n            // Handle cookie removal error\r\n            console.error(\"Error removing cookie:\", error);\r\n          }\r\n        },\r\n      },\r\n    }\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;;;;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAEhC,OAAO,CAAA,GAAA,yKAAA,CAAA,qBAAkB,AAAD,sUAGtB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAY;gBAC3C,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAO,OAAO;oBACd,8BAA8B;oBAC9B,QAAQ,KAAK,CAAC,yBAAyB;gBACzC;YACF;YACA,QAAO,IAAY,EAAE,OAAY;gBAC/B,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;oBAAC;gBAChD,EAAE,OAAO,OAAO;oBACd,8BAA8B;oBAC9B,QAAQ,KAAK,CAAC,0BAA0B;gBAC1C;YACF;QACF;IACF;AAEJ;;;IA9BsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/app/%28auth%29/onboarding/layout.tsx"],"sourcesContent":["// src/app/(auth)/onboarding/layout.tsx\r\nimport { OnboardingProvider } from \"@/contexts/OnboardingContext\";\r\nimport { createClient } from \"@/utils/supabase/server\";\r\nimport { redirect } from \"next/navigation\";\r\n\r\nasync function checkAndRedirectIfComplete() {\r\n  const supabase = await createClient();\r\n\r\n  try {\r\n    // Get the current user\r\n    const {\r\n      data: { user },\r\n      error: userError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (userError || !user) {\r\n      // No user - let middleware handle this\r\n      return;\r\n    }\r\n\r\n    console.log(\r\n      \"üîç Server layout: Checking if onboarding is complete for user:\",\r\n      user.id\r\n    );\r\n\r\n    // Check if onboarding is fully complete\r\n    const { data: onboarding, error: onboardingError } = await supabase\r\n      .from(\"user_onboarding\")\r\n      .select(\"payment_completed, completed_at, user_type, referral_source\")\r\n      .eq(\"user_id\", user.id)\r\n      .maybeSingle();\r\n\r\n    if (onboardingError && onboardingError.code !== \"PGRST116\") {\r\n      console.error(\"Error checking onboarding:\", onboardingError);\r\n      return; // Allow access on error\r\n    }\r\n\r\n    const hasCompletedPayment = onboarding?.payment_completed || false;\r\n    const hasCompletedOnboarding = onboarding?.completed_at !== null;\r\n    const hasOnboardingAnswers = !!(\r\n      onboarding?.user_type && onboarding?.referral_source\r\n    );\r\n\r\n    console.log(\"üìä Onboarding completion status:\", {\r\n      hasCompletedPayment,\r\n      hasCompletedOnboarding,\r\n      hasOnboardingAnswers,\r\n      allComplete:\r\n        hasCompletedPayment && hasCompletedOnboarding && hasOnboardingAnswers,\r\n    });\r\n\r\n    // If everything is complete, redirect to dashboard\r\n    if (hasCompletedPayment && hasCompletedOnboarding && hasOnboardingAnswers) {\r\n      console.log(\"‚úÖ Onboarding fully complete, redirecting to dashboard\");\r\n      redirect(\"/dashboard\");\r\n    }\r\n\r\n    console.log(\r\n      \"üìù Onboarding not complete, allowing access to onboarding pages\"\r\n    );\r\n  } catch (error) {\r\n    console.error(\"üö® Error in onboarding layout:\", error);\r\n    // Allow access on error to prevent blocking users\r\n  }\r\n}\r\n\r\nexport default async function OnboardingLayout({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  // Check if onboarding is complete and redirect if so\r\n  await checkAndRedirectIfComplete();\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center min-h-screen overflow-hidden\">\r\n      <OnboardingProvider>{children}</OnboardingProvider>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,uCAAuC;;;;;AACvC;AACA;AACA;AAAA;;;;;AAEA,eAAe;IACb,MAAM,WAAW,MAAM,CAAA,GAAA,kIAAA,CAAA,eAAY,AAAD;IAElC,IAAI;QACF,uBAAuB;QACvB,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACd,OAAO,SAAS,EACjB,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,IAAI,aAAa,CAAC,MAAM;YACtB,uCAAuC;YACvC;QACF;QAEA,QAAQ,GAAG,CACT,kEACA,KAAK,EAAE;QAGT,wCAAwC;QACxC,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,eAAe,EAAE,GAAG,MAAM,SACxD,IAAI,CAAC,mBACL,MAAM,CAAC,+DACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,WAAW;QAEd,IAAI,mBAAmB,gBAAgB,IAAI,KAAK,YAAY;YAC1D,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,QAAQ,wBAAwB;QAClC;QAEA,MAAM,sBAAsB,YAAY,qBAAqB;QAC7D,MAAM,yBAAyB,YAAY,iBAAiB;QAC5D,MAAM,uBAAuB,CAAC,CAAC,CAC7B,YAAY,aAAa,YAAY,eACvC;QAEA,QAAQ,GAAG,CAAC,oCAAoC;YAC9C;YACA;YACA;YACA,aACE,uBAAuB,0BAA0B;QACrD;QAEA,mDAAmD;QACnD,IAAI,uBAAuB,0BAA0B,sBAAsB;YACzE,QAAQ,GAAG,CAAC;YACZ,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;QACX;QAEA,QAAQ,GAAG,CACT;IAEJ,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;IAChD,kDAAkD;IACpD;AACF;AAEe,eAAe,iBAAiB,EAC7C,QAAQ,EAGT;IACC,qDAAqD;IACrD,MAAM;IAEN,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,qIAAA,CAAA,qBAAkB;sBAAE;;;;;;;;;;;AAG3B","debugId":null}}]
}