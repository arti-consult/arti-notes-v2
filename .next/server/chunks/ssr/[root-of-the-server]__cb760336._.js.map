{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/utils/supabase/server.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { createServerClient } from \"@supabase/ssr\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies();\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        get(name: string) {\r\n          return cookieStore.get(name)?.value;\r\n        },\r\n        set(name: string, value: string, options: any) {\r\n          try {\r\n            cookieStore.set({ name, value, ...options });\r\n          } catch (error) {\r\n            // Handle cookie setting error\r\n            console.error(\"Error setting cookie:\", error);\r\n          }\r\n        },\r\n        remove(name: string, options: any) {\r\n          try {\r\n            cookieStore.set({ name, value: \"\", ...options });\r\n          } catch (error) {\r\n            // Handle cookie removal error\r\n            console.error(\"Error removing cookie:\", error);\r\n          }\r\n        },\r\n      },\r\n    }\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;;;;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAEhC,OAAO,CAAA,GAAA,yKAAA,CAAA,qBAAkB,AAAD,sUAGtB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAY;gBAC3C,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAO,OAAO;oBACd,8BAA8B;oBAC9B,QAAQ,KAAK,CAAC,yBAAyB;gBACzC;YACF;YACA,QAAO,IAAY,EAAE,OAAY;gBAC/B,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;oBAAC;gBAChD,EAAE,OAAO,OAAO;oBACd,8BAA8B;oBAC9B,QAAQ,KAAK,CAAC,0BAA0B;gBAC1C;YACF;QACF;IACF;AAEJ;;;IA9BsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/app/%28auth%29/sign-up/actions.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { revalidatePath } from \"next/cache\";\r\nimport { redirect } from \"next/navigation\";\r\nimport { createClient } from \"@/utils/supabase/server\";\r\n\r\nexport async function signup(formData: FormData) {\r\n  console.log(\"=== SIGNUP ACTION START ===\", new Date().toISOString());\r\n\r\n  const supabase = await createClient();\r\n\r\n  const password = formData.get(\"password\") as string;\r\n  const confirmPassword = formData.get(\"confirmPassword\") as string;\r\n  const email = formData.get(\"email\") as string;\r\n  const paymentLinkTag = formData.get(\"paymentLinkTag\") as string;\r\n\r\n  console.log(\r\n    \"Signup attempt for email:\",\r\n    email,\r\n    \"with payment tag:\",\r\n    paymentLinkTag\r\n  );\r\n\r\n  // Validate password match\r\n  if (password !== confirmPassword) {\r\n    console.log(\"Password mismatch\");\r\n    return { error: \"Passwords do not match\" };\r\n  }\r\n\r\n  const data = {\r\n    email: email,\r\n    password: password,\r\n    options: {\r\n      data: {\r\n        payment_link_tag: paymentLinkTag || null, // Store in user metadata\r\n      },\r\n    },\r\n  };\r\n\r\n  console.log(\"Calling supabase.auth.signUp...\");\r\n  const signUpStartTime = Date.now();\r\n\r\n  const { data: authData, error } = await supabase.auth.signUp(data);\r\n\r\n  const signUpEndTime = Date.now();\r\n  console.log(`SignUp completed in ${signUpEndTime - signUpStartTime}ms`);\r\n\r\n  console.log(\"SignUp result:\", {\r\n    user: authData.user\r\n      ? {\r\n          id: authData.user.id,\r\n          email: authData.user.email,\r\n          email_confirmed_at: authData.user.email_confirmed_at,\r\n          created_at: authData.user.created_at,\r\n          payment_link_tag: authData.user.user_metadata?.payment_link_tag,\r\n        }\r\n      : null,\r\n    session: authData.session\r\n      ? {\r\n          access_token: authData.session.access_token ? \"present\" : \"missing\",\r\n          refresh_token: authData.session.refresh_token ? \"present\" : \"missing\",\r\n          expires_at: authData.session.expires_at,\r\n          user_id: authData.session.user?.id,\r\n        }\r\n      : null,\r\n    error: error?.message,\r\n  });\r\n\r\n  if (error) {\r\n    console.log(\"Signup error:\", error.message);\r\n    return { error: error.message };\r\n  }\r\n\r\n  // Check if user was created but needs email confirmation\r\n  if (authData.user && !authData.session) {\r\n    console.log(\"User created but no session - needs email confirmation\");\r\n    return {\r\n      success: true,\r\n      needsConfirmation: true,\r\n      message:\r\n        \"Please check your email and click the confirmation link to continue.\",\r\n    };\r\n  }\r\n\r\n  // Check if we have a session\r\n  if (authData.session) {\r\n    console.log(\r\n      \"User created with session, proceeding to create onboarding record\"\r\n    );\r\n\r\n    // Ensure session cookies are properly set by setting the session explicitly\r\n    const { error: setSessionError } = await supabase.auth.setSession({\r\n      access_token: authData.session.access_token,\r\n      refresh_token: authData.session.refresh_token,\r\n    });\r\n\r\n    if (setSessionError) {\r\n      console.error(\"Error setting session:\", setSessionError);\r\n    } else {\r\n      console.log(\"Session explicitly set on server\");\r\n    }\r\n\r\n    // Create initial onboarding record with nullable fields\r\n    try {\r\n      const { error: onboardingError } = await supabase\r\n        .from(\"user_onboarding\")\r\n        .insert({\r\n          user_id: authData.user?.id,\r\n          payment_completed: false,\r\n          payment_link_tag: paymentLinkTag || null,\r\n          // Make all fields explicitly nullable\r\n          user_type: null,\r\n          team_size: null,\r\n          referral_source: null,\r\n          audio_purpose: null,\r\n          mic_permission: false, // Default value\r\n          completed_at: null,\r\n          created_at: new Date().toISOString(),\r\n          updated_at: new Date().toISOString(),\r\n        });\r\n\r\n      if (onboardingError) {\r\n        console.error(\"Error creating onboarding record:\", onboardingError);\r\n        // Don't fail signup, but log the error\r\n      } else {\r\n        console.log(\r\n          \"Created initial onboarding record with payment tag:\",\r\n          paymentLinkTag\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Exception creating onboarding record:\", error);\r\n    }\r\n\r\n    console.log(\"Calling revalidatePath...\");\r\n    revalidatePath(\"/\", \"layout\");\r\n\r\n    // Don't redirect here - let the frontend handle the payment redirect\r\n    console.log(\"Signup successful, returning success response\");\r\n    return {\r\n      success: true,\r\n      paymentLinkTag: paymentLinkTag,\r\n      user: authData.user,\r\n    };\r\n  }\r\n\r\n  // Fallback - shouldn't happen but handle it\r\n  console.log(\"Unexpected signup state - no session created\");\r\n  return {\r\n    error:\r\n      \"Signup completed but no session was created. Please try logging in.\",\r\n  };\r\n}\r\n\r\nexport async function signInWithGoogle() {\r\n  console.log(\"=== GOOGLE SIGNIN START ===\");\r\n  const supabase = await createClient();\r\n\r\n  const { data, error } = await supabase.auth.signInWithOAuth({\r\n    provider: \"google\",\r\n    options: {\r\n      redirectTo: `${process.env.NEXT_PUBLIC_SITE_URL}/auth/callback?next=/payment`,\r\n    },\r\n  });\r\n\r\n  console.log(\"Google OAuth result:\", {\r\n    hasUrl: !!data.url,\r\n    url: data.url,\r\n    error: error?.message,\r\n  });\r\n\r\n  if (error) {\r\n    console.log(\"Google OAuth error:\", error);\r\n    redirect(\"/error?message=\" + encodeURIComponent(error.message));\r\n  }\r\n\r\n  // For OAuth, the redirect happens automatically\r\n  if (data.url) {\r\n    console.log(\"Redirecting to Google OAuth URL\");\r\n    redirect(data.url);\r\n  }\r\n}\r\n\r\nexport async function signInWithMicrosoft() {\r\n  console.log(\"=== MICROSOFT SIGNIN START ===\");\r\n  const supabase = await createClient();\r\n\r\n  const { data, error } = await supabase.auth.signInWithOAuth({\r\n    provider: \"azure\",\r\n    options: {\r\n      redirectTo: `${process.env.NEXT_PUBLIC_SITE_URL}/auth/callback?next=/payment`,\r\n    },\r\n  });\r\n\r\n  console.log(\"Microsoft OAuth result:\", {\r\n    hasUrl: !!data.url,\r\n    url: data.url,\r\n    error: error?.message,\r\n  });\r\n\r\n  if (error) {\r\n    console.log(\"Microsoft OAuth error:\", error);\r\n    redirect(\"/error?message=\" + encodeURIComponent(error.message));\r\n  }\r\n\r\n  // For OAuth, the redirect happens automatically\r\n  if (data.url) {\r\n    console.log(\"Redirecting to Microsoft OAuth URL\");\r\n    redirect(data.url);\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/.next-internal/server/app/%28auth%29/sign-up/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {signup as '40e2e96b184365ca49be176bc0a9e082e8c985c13f'} from 'ACTIONS_MODULE0'\nexport {signInWithGoogle as '00ab0c8391139fc3c22aca998772286d1a711da417'} from 'ACTIONS_MODULE0'\nexport {signInWithMicrosoft as '006ed028e74cd5196a24223a69b41ef8a32901e2e9'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 369, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/app/%28auth%29/sign-up/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(auth)/sign-up/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(auth)/sign-up/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAmS,GAChU,iEACA","debugId":null}},
    {"offset": {"line": 383, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/app/%28auth%29/sign-up/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(auth)/sign-up/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(auth)/sign-up/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA+Q,GAC5S,6CACA","debugId":null}},
    {"offset": {"line": 397, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}