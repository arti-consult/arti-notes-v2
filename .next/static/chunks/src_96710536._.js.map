{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/utils/supabase/client.ts"],"sourcesContent":["import { createBrowserClient } from \"@supabase/ssr\";\r\n\r\nexport function createClient() {\r\n  return createBrowserClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;AAII;AAJJ;AAAA;;AAEO,SAAS;IACd,OAAO,CAAA,GAAA,6KAAA,CAAA,sBAAmB,AAAD;AAI3B","debugId":null}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///D:/breyholtz%20holding/arti-notes/arti-notes-v3/src/contexts/AuthContext.tsx"],"sourcesContent":["// src/contexts/AuthContext.tsx\r\n\"use client\";\r\n\r\nimport {\r\n  createContext,\r\n  ReactNode,\r\n  useContext,\r\n  useState,\r\n  useEffect,\r\n} from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { createClient } from \"@/utils/supabase/client\";\r\nimport { UserSubscription } from \"@/types/subscription\";\r\nimport { Profile } from \"@/types/auth\";\r\nimport { User, Session } from \"@supabase/supabase-js\";\r\n\r\nexport interface AuthUser {\r\n  id: string;\r\n  email?: string;\r\n  user_metadata?: {\r\n    full_name?: string;\r\n    avatar_url?: string;\r\n  };\r\n}\r\n\r\ninterface AuthContextType {\r\n  user: AuthUser | null;\r\n  profile: Profile | null;\r\n  session: Session | null;\r\n  subscription: UserSubscription | null;\r\n  isLoading: boolean;\r\n  signOut: () => Promise<void>;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\ninterface AuthProviderProps {\r\n  children: ReactNode;\r\n  initialUser?: AuthUser | null;\r\n}\r\n\r\nexport function AuthProvider({ children, initialUser }: AuthProviderProps) {\r\n  const [user, setUser] = useState<AuthUser | null>(initialUser || null);\r\n  const [profile, setProfile] = useState<Profile | null>(null);\r\n  const [session, setSession] = useState<Session | null>(null);\r\n  const [subscription, setSubscription] = useState<UserSubscription | null>(\r\n    null\r\n  );\r\n  const [isLoading, setIsLoading] = useState(!initialUser);\r\n  const router = useRouter();\r\n  const supabase = createClient();\r\n\r\n  useEffect(() => {\r\n    const fetchUserData = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n\r\n        const {\r\n          data: { session },\r\n        } = await supabase.auth.getSession();\r\n        setSession(session);\r\n        setUser(session?.user || null);\r\n\r\n        if (session?.user) {\r\n          // Get profile\r\n          const { data: profileData } = await supabase\r\n            .from(\"profiles\")\r\n            .select(\"*\")\r\n            .eq(\"id\", session.user.id)\r\n            .single();\r\n\r\n          setProfile(profileData);\r\n\r\n          // Get active subscription\r\n          const { data: subscriptionData } = await supabase\r\n            .from(\"subscriptions\")\r\n            .select(\r\n              `\r\n              *,\r\n              plan:pricing_plans(*)\r\n            `\r\n            )\r\n            .eq(\"user_id\", session.user.id)\r\n            .eq(\"status\", \"active\")\r\n            .single();\r\n\r\n          if (subscriptionData) {\r\n            setSubscription(subscriptionData);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching user data:\", error);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    if (initialUser) {\r\n      console.log(\"AuthProvider - Setting initial user:\", initialUser);\r\n      setUser(initialUser);\r\n      setIsLoading(false);\r\n    } else {\r\n      fetchUserData();\r\n    }\r\n\r\n    const {\r\n      data: { subscription },\r\n    } = supabase.auth.onAuthStateChange((_event, session) => {\r\n      setSession(session);\r\n      setUser(session?.user || null);\r\n\r\n      if (session) {\r\n        fetchUserData();\r\n      } else {\r\n        setProfile(null);\r\n        setSubscription(null);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      subscription.unsubscribe();\r\n    };\r\n  }, [supabase, router, initialUser]);\r\n\r\n  const signOut = async () => {\r\n    await supabase.auth.signOut();\r\n    router.push(\"/login\");\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{ user, profile, session, subscription, isLoading, signOut }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error(\"useAuth must be used within an AuthProvider\");\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;AAG/B;AAOA;AACA;;;AAVA;;;;AAiCA,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAA+B;AAOxD,SAAS,aAAa,EAAE,QAAQ,EAAE,WAAW,EAAqB;;IACvE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAmB,eAAe;IACjE,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkB;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAC7C;IAEF,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,CAAC;IAC5C,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,eAAY,AAAD;IAE5B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,MAAM;wDAAgB;oBACpB,IAAI;wBACF,aAAa;wBAEb,MAAM,EACJ,MAAM,EAAE,OAAO,EAAE,EAClB,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;wBAClC,WAAW;wBACX,QAAQ,SAAS,QAAQ;wBAEzB,IAAI,SAAS,MAAM;4BACjB,cAAc;4BACd,MAAM,EAAE,MAAM,WAAW,EAAE,GAAG,MAAM,SACjC,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QAAQ,IAAI,CAAC,EAAE,EACxB,MAAM;4BAET,WAAW;4BAEX,0BAA0B;4BAC1B,MAAM,EAAE,MAAM,gBAAgB,EAAE,GAAG,MAAM,SACtC,IAAI,CAAC,iBACL,MAAM,CACL,CAAC;;;YAGH,CAAC,EAEA,EAAE,CAAC,WAAW,QAAQ,IAAI,CAAC,EAAE,EAC7B,EAAE,CAAC,UAAU,UACb,MAAM;4BAET,IAAI,kBAAkB;gCACpB,gBAAgB;4BAClB;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,6BAA6B;oBAC7C,SAAU;wBACR,aAAa;oBACf;gBACF;;YAEA,IAAI,aAAa;gBACf,QAAQ,GAAG,CAAC,wCAAwC;gBACpD,QAAQ;gBACR,aAAa;YACf,OAAO;gBACL;YACF;YAEA,MAAM,EACJ,MAAM,EAAE,YAAY,EAAE,EACvB,GAAG,SAAS,IAAI,CAAC,iBAAiB;0CAAC,CAAC,QAAQ;oBAC3C,WAAW;oBACX,QAAQ,SAAS,QAAQ;oBAEzB,IAAI,SAAS;wBACX;oBACF,OAAO;wBACL,WAAW;wBACX,gBAAgB;oBAClB;gBACF;;YAEA;0CAAO;oBACL,aAAa,WAAW;gBAC1B;;QACF;iCAAG;QAAC;QAAU;QAAQ;KAAY;IAElC,MAAM,UAAU;QACd,MAAM,SAAS,IAAI,CAAC,OAAO;QAC3B,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,6LAAC,YAAY,QAAQ;QACnB,OAAO;YAAE;YAAM;YAAS;YAAS;YAAc;YAAW;QAAQ;kBAEjE;;;;;;AAGP;GA/FgB;;QAQC,qIAAA,CAAA,YAAS;;;KARV;AAiGT,SAAS;;IACd,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB","debugId":null}}]
}